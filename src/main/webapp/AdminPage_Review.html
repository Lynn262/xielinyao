<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>管·评价界面</title>
	<link rel="stylesheet" href="css/AdminPage_style.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/tanchuang_Review.css">
	<!-- CSS -->

</head>
<body onload="showall()">
<div class="shuipingxian">
	<div >评价管理界面</div>
</div>
<!-- 这是一条水平线 -->
<div class="shuipingxian2"></div>
<table    class="class2" >
	<tr >
		<td  class="class_border1">
			<a class="pic" href="AdminPage.html">
				<i class="fa fa-home"  style="color: #000000;"></i>
				<font  color="white">首页</font></a>
		</td>
	</tr>
	<tr>
		<td  class="class_border">
			<a class="pic" href="AdminPage.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font color="white">管理学生信息 </font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_tea.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font color="white">管理教师信息</font> </a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_Cur.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font  color="white">管理课程信息</font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_Review.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font  color="white">管理评价信息</font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
</table>
<div class="box">
	<div class="TOP">

	</div>
	<div class="THead_R" >
		<div style="color: white;font-size: 28px;text-align: center;"  >审核评价</div>
		<div >
			<button onclick="dianwo()" class="change_R">
				封禁学生
			</button>
		</div>
		<div class="zhezhao" id='zhezhao'>
			<div class="tankuang">
				<div id="header">
					<span class="h1">封禁学生</span>
					<span class="h2">
										<font  color="red">提示：请您对学生的账号有效期进行修改</font></span>
					<input type="text" placeholder="请输入学生的学号" id="sno" style="margin-top: 110px;height: 25px;" />
					<span class="h3">请选择该学生的封禁截止日期：</span>
					<!-- 下面是点击×可以剪掉网页的设置 -->
					<div id="header-right" onclick="hidder()">x</div>
					<input type="date" name="d1" id="d1" value="2020-12-1" class="date1"/>
					<input type="submit" name="" id="" value="提交信息" class="submit1" onclick="lockacc()"/>
				</div>
			</div>
		</div>
	</div>
	<div class="infoD">
		<table class="infoT">
			<tbody>
			<thead>
			<td class="infoH">
				发布者学号
			</td>
			<td class="infoHH">
				评价内容
			</td>
			<td class="infoH">
				举报原因
			</td>
			<td class="infoH">
				恢复与恢复
			</td>
			</thead>
			<tbody id="reviewcontent">
			<tr>
				<td class="info">
					王晓红
				</td>
				<td class="info">
					这个老师有毒。这个老师有毒。这个老师有毒。这个老师有毒。这个老师有毒。
				</td>
				<td class="info">
					不文明用语
				</td>
				<td class="infoH">
					<button onclick="dele()" style="margin-right: 50px;">
						删除
					</button>
					<button type="button" onclick="recover()">
						恢复
					</button>
				</td>
			</tr>
			</tbody>
			</tbody>
		</table>
	</div>
</div>

<!-- 这是弹窗的js代码 -->
<script src="js/jquery-1.11.2.min.js"></script>
<script type="text/javascript">
	function lockacc(){
		var time1 = document.getElementById("d1").value;
		var sno = document.getElementById("sno").value;
		var url1 = "student/updatestate?Sno=" + sno + "&Sstate=" + time1;

		$.ajax({
			type : "POST",
			url : url1,
			success : function(response){
				if(response == 1)
					alert("封禁成功");
				else
					alert("封禁失败");
			}
		})
	}

	document.getElementById('zhezhao').style.display="none";
	function dianwo(){
		document.getElementById('zhezhao').style.display="";
	}
	function hidder(){
		document.getElementById('zhezhao').style.display="none";
	}

	document.getElementById('zhezhao1').style.display="none";
	function dianwo1(){
		document.getElementById('zhezhao1').style.display="";
	}
	function hidder1(){
		document.getElementById('zhezhao1').style.display="none";
	}

	document.getElementById('zhezhao1').style.display="none";
	function dianwo3(){
		document.getElementById('zhezhao1').style.display="";
	}
	function hidder3(){
		document.getElementById('zhezhao1').style.display="none";
	}

	function dele(rev_id){
		if (confirm("确认删除此评价吗？")==true)
		{
			var url1 = "review/deleRev?id_review=" + rev_id;
			$.ajax({
				url : url1,
				type : "DELETE",
				async : false,
				success : function(){
					alert("删除成功");
					showall();
				},
				error : function(){
					alert("删除失败");
				}
			})

		}
	}

	function recover(rev_id){
		var url1 = "review/approverev?id_review=" + rev_id;
		$.ajax({
			url : url1,
			type : "POST",
			async : false,
			success : function(){
				showall();
			},
			error : function(){
				alert("删除失败");
			}
		})
	}

	function showreview(reviews){
		var len = reviews.length;
		var temp = "";
		var revewdisp = "";
		var str1 = "<tr> <td class=\"info\">";
		var str2 = "</td> <td class=\"info\">";
		var str3 = "</td> <td class=\"info\">";
		var str4 = "";
		var str5 = "</td> <td class=\"infoH\"> <button onclick=\"dele(";
		var str6 = ")\" style=\"margin-right: 50px;\">"
		var str7 = "</button> <button type=\"button\" onclick=\"recover(";
		var str8 = ")\">";
		var str9 = "</button> </td> </tr>";

		for(var i = 0; i < len; i++){
			if(reviews[i].state == 2){
				str4 = "申请删除";
			}
			else if(reviews[i].state == 3){
				str4 = "被举报";
			}
			else{
				str4 = "不明原因";
			}
			temp = str1 + reviews[i].sno + str2 + reviews[i].comment + str3 + str4 + str5 + reviews[i].id_review +
					str6 +"删除" + str7 + reviews[i].id_review + str8 + "恢复" + str9;
			revewdisp += temp;
		}
		$("#reviewcontent").html(revewdisp);
	}

	function showall(){
		$.ajax({
			url : "review/getreport",
			type : "GET",
			async : false,
			success : function(reviews){
				showreview(reviews);
			},
			error : function(){
				alert("连接失败");
			}
		})
	}

	document.getElementById('zhezhao2').style.display="none";
	function dianwo2(){
		document.getElementById('zhezhao2').style.display="";
	}
	function hidder2(){
		document.getElementById('zhezhao2').style.display="none";
	}
</script>
<!-- 这是弹窗的js代码 -->
</body>
</html>



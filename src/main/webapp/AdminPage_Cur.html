<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>管·课程界面</title>
	<link rel="stylesheet" href="css/AdminPage_style.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/tanchuang_tea.css">
	<!-- CSS -->

</head>
<body onload="showall()">
<div class="shuipingxian">
	<div >课程管理界面</div>
</div>
<!-- 这是一条水平线 -->
<div class="shuipingxian2"></div>
<table    class="class2" >
	<tr >
		<td  class="class_border1">
			<a class="pic" href="AdminPage.html">
				<i class="fa fa-home"  style="color: #000000;"></i>
				<font  color="white">首页</font></a>
		</td>
	</tr>
	<tr>
		<td  class="class_border">
			<a class="pic" href="AdminPage.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font color="white">管理学生信息 </font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_tea.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font color="white">管理教师信息</font> </a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_Cur.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font  color="white">管理课程信息</font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" class="class_border">
			<a class="pic" href="AdminPage_Review.html">
				<i class="fa fa-tasks"  style="color: #000000;"></i>
				<font  color="white">管理评价信息</font>
			</a>
		</td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
	<tr>
		<td align="center" ></td>
	</tr>
</table>
<div class="box">
	<div class="TOP">
		课程信息
	</div>
	<div class="THead">
		<input style="width:600px;height:30px;margin-top:15px;margin-left: 80px;font-size:15px" id = "searchcontent">
		<button style="height:35px;width:50px;font-size:15px;cursor: pointer;" onclick="queryByname()">搜索</button>
		<button onclick="dianwo1()" class="add">
			增加课程信息
		</button>
		<button type="button" class="change" onclick="dianwo()">
			修改课程信息
		</button>
		<div class="zhezhao" id='zhezhao'>
			<div class="tankuang1">
				<div>
					<span class="h1">修改课程信息</span>
					<span class="h5">请在需要修改信息的框里面键入新的信息</span>
					<!-- 这里后端可不可以做成先置入信息，然后如果有需要修改的再进行修改？我就把placeholder改成value了哈
                     就是希望这里面的value可以是数据库里面的值-->
					<!-- 自动填充已实现-->
					<input type="text" name="d1" id="uc1" value="请重置该课程号" class="switch1"/>
					<input type="text" name="d1" id="uc2" onclick="fillupdate()" value="请重置该课程名称" class="switch2"/>
					<input type="text" name="d1" id="uc3" value="请重置该课程学期" class="switch3"/>
					<input type="text" name="d1" id="uc4" value="请重置该课程学分" class="switch4"/>
					<input type="text" name="d1" id="uc5" value="请重置该课程的所属院系" class="switch5"/>
					<div id="header-right" onclick="hidder()">x</div>
					<input type="submit" name="" value="提交信息" class="submit1" onclick="saveupdate()"/>
				</div>
			</div>
		</div>
		<div class="zhezhao1" id='zhezhao1'>
			<div class="tankuang1">
				<div id="header">
					<!-- 昵称学号名称密码密码 -->
					<div style="cursor: pointer;">
						<div class="honey" >增加课程信息</div>
						<span class="h51">请您在下面的输入框中根据提示置入课程的信息</span>
					</div>
					<!-- 下面是点击×可以剪掉网页的设置 -->
					<div id="header-right" onclick="hidder1()">x</div>
					<input type="text" name="d1" id="nc1" placeholder="请输入该课程的课程号" class="switch1"/>
					<input type="text" name="d1" id="nc2" placeholder="请输入该课程名称" class="switch2"/>
					<input type="text" name="d1" id="nc3" placeholder="请输入该课程学期" class="switch3"/>
					<input type="text" name="d1" id="nc4" placeholder="请输入该课程的学分" class="switch4"/>
					<input type="text" name="d1" id="nc5" placeholder="请输入该课程的所属院系" class="switch5"/>
					<input type="submit" name="" value="提交信息" class="submit2" onclick="savecourse()"/>
				</div>
			</div>
		</div>
	</div>
	<div class="infoD">
		<table class="infoT">
			<tbody>
			<thead>
			<td class="infoH">
				课程号
			</td>
			<td class="infoH">
				课程名称
			</td>
			<td class="infoH">
				课程学期
			</td>
			<td class="infoH">
				课程学分（分）
			</td>
			<td class="infoH">
				课程所属院系
			</td>
			<td class="infoH">
				删除
			</td>
			</thead>
			<tbody id = "courses">
			<tr >
				<td class="info">
					1
				</td>
				<td class="info">
					高数1
				</td>
				<td class="info">
					1
				</td>
				<td class="info">
					4
				</td>
				<td class="info">
					信息工程学院
				</td>
				<td class="infoH">
					<button onclick="dele()" style="cursor: pointer;">
						删除
					</button>
				</td>
			</tr>
			</tbody>
			</tbody>
		</table>
	</div>
</div>
<!-- 这是弹窗的js代码 -->
<script src="js/jquery-1.11.2.min.js"></script>
<script type="text/javascript">

	document.getElementById('zhezhao').style.display="none";
	function dianwo(){
		document.getElementById('zhezhao').style.display="";
	}
	function hidder(){
		document.getElementById('zhezhao').style.display="none";
	}

	document.getElementById('zhezhao1').style.display="none";
	function dianwo1(){
		document.getElementById('zhezhao1').style.display="";
	}
	function hidder1(){
		document.getElementById('zhezhao1').style.display="none";
	}

	function dele(cno){

		if (confirm("确认删除此条课程记录吗？")==true)
		{
			var url1 = "course/deletecourse?Cno=" + cno;
			$.ajax({
				url : url1,
				type : "DELETE",
				async : false,
				success :function(){
					alert("删除成功");
				},
				error : function(){
					alert("删除失败");
				}
			})
		}
	}

	function showCourse(Courses){
		var len = Courses.length;
		var temp = "";
		var coursedisp = "";
		var str1 = "<tr> <td class=\"info\">";
		var str2 = "</td> <td class=\"info\">";
		var str3 = "</td> <td class=\"info\">";
		var str4 = "</td> <td class=\"info\">";
		var str5 = "</td> <td class=\"info\">";
		var str6 = "<td class=\"infoH\"> <button onclick=\"dele(";
		var str7 = ")\" style=\"cursor: pointer;\"> 删除 </button> </td> </tr>";

		for(var i = 0; i < len; i++){
			temp = str1 + Courses[i].cno + str2 + Courses[i].cname + str3 + Courses[i].cterm + str4 +
					Courses[i].ccredit + str5 + Courses[i].cdept + str6 + Courses[i].cno + str7;
			coursedisp += temp;
		}
		$("#courses").html(coursedisp);
	}

	function showall(){
		$.ajax({
			url : "course/getallc",
			type : "GET",
			async : false,
			success : function (Courses){
				showCourse(Courses);
			}
		})
	}

	function queryByname(){
		var q1 = document.getElementById("searchcontent").value;
		var url1 = "course/querybyname?cname="+q1;

		$.ajax({
			url : url1,
			type : "GET",
			success : function(Course){
				showCourse(Course);
			}
		})
	}

	//用于填充修改课程信息函数的其余部分
	function fillupdate(){
		var cno1 = document.getElementById("uc1").value;
		var url1 = "course/querycourse?Cno=" + cno1;

		$.ajax({
			url : url1,
			type : "GET",
			success : function(c1){
				//获取当前输入框中的话并判断判断哪个被用户更改过
				var cname1 = document.getElementById("uc2").value;
				var cterm1 = document.getElementById("uc3").value;
				var credit1 = document.getElementById("uc4").value;
				var cdept1 = document.getElementById("uc5").value;

				if(c1.cno == cno1){
					if(cname1 == "请重置该课程名称"){
						$("#uc2").val(c1.cname);
					}
					if(cterm1 == "请重置该课程学期"){
						$("#uc3").val(c1.cterm);
					}
					if(credit1 == "请重置该课程学分"){
						$("#uc4").val(c1.ccredit);
					}
					if(cdept1 == "请重置该课程的所属院系"){
						$("#uc5").val(c1.cdept);
					}
				}
			}
		})
	}

	function saveupdate(){
		var cno1 = document.getElementById("uc1").value;
		var cname1 = document.getElementById("uc2").value;
		var cterm1 = document.getElementById("uc3").value;
		var credit1 = document.getElementById("uc4").value;
		var cdept1 = document.getElementById("uc5").value;

		var course1 = JSON.stringify({"cno" : cno1, "cname" : cname1, "cterm" : cterm1,
			"ccredit" : credit1, "cdept" : cdept1})

		$.ajax({
			url : "course/updatecourse",
			type : "POST",
			data : course1,
			dataType : "json",
			contentType : "application/json",
			success : function(response){
				if(response == 1){
					alert("更新成功");
					hidder();
				}
				else{
					alert("更新失败");
				}
			}
		})
	}

	function savecourse(){
		var cno1 = document.getElementById("nc1").value;
		var cname1 = document.getElementById("nc2").value;
		var cterm1 = document.getElementById("nc3").value;
		var credit1 = document.getElementById("nc4").value;
		var cdept1 = document.getElementById("nc5").value;

		var course1 = JSON.stringify({"cno" : cno1, "cname" : cname1, "cterm" : cterm1,
			"ccredit" : credit1, "cdept" : cdept1})

		$.ajax({
			url : "course/savecourse",
			type : "POST",
			data : course1,
			dataType : "json",
			contentType : "application/json",
			success : function(response){
				if(response == 1){
					alert("增加成功");
					hidder();
				}
				else{
					alert("增加失败");
				}
			}
		})
	}

</script>
<!-- 这是弹窗的js代码 -->
</body>
</html>


